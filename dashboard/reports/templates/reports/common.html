{% macro detail_report(report, id) %}

<tr>
    <td>{{ id }}</td>
    <td><a href="{{ url_for('custom_report.show_report', report_id=report.id) }}">{{ report.name }}</a></td>
    <td>{{ report.description }}</td>
    <td>{{ report.url | format_url}}</td>
    <td user-id="{{ report.id }}">
    <div class="span1">
        <a class="report-delete-link" href="#" data-delete-url="{{ url_for('report_rest_api.delete_report', report_id=report.id) }}">
            <i class="icon-trash"></i>
        </a>
        <a class="report-edit-link" href="{{ url_for('custom_report.edit_report', report_id=report.id) }}">
            <i class="icon-edit"></i>
        </a>
    </div>
    </td>
</tr>
{% endmacro %}

{% macro table_report(reports) %}
    {% set count = 0 %}
    {% for report in reports %}
            {% set columns = report['data'][0].keys() %}
            {% set title = columns[0] | filter_table_header %}
            <h4 class="text-center"> {{ title }}</h4>
            <table class="table table-striped table-hover" id="example_{{ count }}">
                <thead>
                    <tr>
                    {% for column in columns %}
                        <th>{{ column }}</th>
                    {% endfor %}
                        <th>Total</th>
                    </tr>
                </thead>
                {% set total_columns = [] %}
                {% for row in report['data'] %}
                    <tr>
                    {% for column in columns %}
                        <td> {{ row[column] }}</td>
                    {% endfor %}
                        {% set row_val = row.values() | get_list_of_ints | sum | int %}
                        {% do total_columns.append(row_val) %}
                        <td>{{ row_val }}</td>
                    </tr>
                {% endfor %}
                <tfoot>
                    <tr>
                        <td>Total</td>
                        {% for column in columns[1:] %}
                            {% set total = [] %}
                            {% for row in report['data'] %}
                                {% do total.append(row[column] | int) %}
                            {% endfor %}
                            <td>{{ total | sum }}</td>
                        {% endfor %}
                        <td>{{ total_columns | sum}}</td>
                    </tr>
                </tfoot>
            </table>
            {% set count = count + 1 %}
    {% endfor %}
{% endmacro %}
